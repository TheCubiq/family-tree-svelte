var tt=Object.defineProperty;var nt=(s,e,t)=>e in s?tt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var re=(s,e,t)=>(nt(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function O(){}const st=s=>s;function Y(s,e){for(const t in e)s[t]=e[t];return s}function Ue(s){return s()}function ge(){return Object.create(null)}function V(s){s.forEach(Ue)}function ue(s){return typeof s=="function"}function F(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}function it(s){return Object.keys(s).length===0}function ot(s,...e){if(s==null){for(const n of e)n(void 0);return O}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function rt(s,e,t){s.$$.on_destroy.push(ot(e,t))}function Ne(s,e,t,n){if(s){const i=De(s,e,t,n);return s[0](i)}}function De(s,e,t,n){return s[1]&&n?Y(t.ctx.slice(),s[1](n(e))):t.ctx}function xe(s,e,t,n){if(s[2]&&n){const i=s[2](n(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],r=Math.max(e.dirty.length,i.length);for(let a=0;a<r;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}function Fe(s,e,t,n,i,o){if(i){const r=De(e,t,n,o);s.p(r,i)}}function ze(s){if(s.ctx.length>32){const e=[],t=s.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function be(s){const e={};for(const t in s)t[0]!=="$"&&(e[t]=s[t]);return e}function ye(s){return s??""}function we(s){const e=typeof s=="string"&&s.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[s,"px"]}const Ke=typeof window<"u";let at=Ke?()=>window.performance.now():()=>Date.now(),he=Ke?s=>requestAnimationFrame(s):O;const U=new Set;function Be(s){U.forEach(e=>{e.c(s)||(U.delete(e),e.f())}),U.size!==0&&he(Be)}function ct(s){let e;return U.size===0&&he(Be),{promise:new Promise(t=>{U.add(e={c:s,f:t})}),abort(){U.delete(e)}}}function S(s,e){s.appendChild(e)}function We(s){if(!s)return document;const e=s.getRootNode?s.getRootNode():s.ownerDocument;return e&&e.host?e:s.ownerDocument}function lt(s){const e=P("style");return e.textContent="/* empty */",ut(We(s),e),e.sheet}function ut(s,e){return S(s.head||s,e),e.sheet}function T(s,e,t){s.insertBefore(e,t||null)}function k(s){s.parentNode&&s.parentNode.removeChild(s)}function Me(s,e){for(let t=0;t<s.length;t+=1)s[t]&&s[t].d(e)}function P(s){return document.createElement(s)}function R(s){return document.createTextNode(s)}function x(){return R(" ")}function ht(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function C(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function dt(s){return Array.from(s.childNodes)}function X(s,e){e=""+e,s.data!==e&&(s.data=e)}function ft(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}const Z=new Map;let ee=0;function pt(s){let e=5381,t=s.length;for(;t--;)e=(e<<5)-e^s.charCodeAt(t);return e>>>0}function mt(s,e){const t={stylesheet:lt(e),rules:{}};return Z.set(s,t),t}function gt(s,e,t,n,i,o,r,a=0){const l=16.666/n;let c=`{
`;for(let m=0;m<=1;m+=l){const g=e+(t-e)*o(m);c+=m*100+`%{${r(g,1-g)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,h=`__svelte_${pt(u)}_${a}`,d=We(s),{stylesheet:p,rules:f}=Z.get(d)||mt(d,s);f[h]||(f[h]=!0,p.insertRule(`@keyframes ${h} ${u}`,p.cssRules.length));const b=s.style.animation||"";return s.style.animation=`${b?`${b}, `:""}${h} ${n}ms linear ${i}ms 1 both`,ee+=1,h}function Se(s,e){const t=(s.style.animation||"").split(", "),n=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=t.length-n.length;i&&(s.style.animation=n.join(", "),ee-=i,ee||bt())}function bt(){he(()=>{ee||(Z.forEach(s=>{const{ownerNode:e}=s.stylesheet;e&&k(e)}),Z.clear())})}let B;function K(s){B=s}function yt(){if(!B)throw new Error("Function called outside component initialization");return B}function wt(s){yt().$$.on_mount.push(s)}const $=[],_e=[];let N=[];const Ce=[],St=Promise.resolve();let le=!1;function _t(){le||(le=!0,St.then(He))}function W(s){N.push(s)}const ae=new Set;let q=0;function He(){if(q!==0)return;const s=B;do{try{for(;q<$.length;){const e=$[q];q++,K(e),Ct(e.$$)}}catch(e){throw $.length=0,q=0,e}for(K(null),$.length=0,q=0;_e.length;)_e.pop()();for(let e=0;e<N.length;e+=1){const t=N[e];ae.has(t)||(ae.add(t),t())}N.length=0}while($.length);for(;Ce.length;)Ce.pop()();le=!1,ae.clear(),K(s)}function Ct(s){if(s.fragment!==null){s.update(),V(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(W)}}function vt(s){const e=[],t=[];N.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),N=e}let z;function kt(){return z||(z=Promise.resolve(),z.then(()=>{z=null})),z}function ve(s,e,t){s.dispatchEvent(ft(`${e?"intro":"outro"}${t}`))}const Q=new Set;let I;function de(){I={r:0,c:[],p:I}}function fe(){I.r||V(I.c),I=I.p}function y(s,e){s&&s.i&&(Q.delete(s),s.i(e))}function v(s,e,t,n){if(s&&s.o){if(Q.has(s))return;Q.add(s),I.c.push(()=>{Q.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}const Ot={duration:0};function Pt(s,e,t){const n={direction:"in"};let i=e(s,t,n),o=!1,r,a,l=0;function c(){r&&Se(s,r)}function u(){const{delay:d=0,duration:p=300,easing:f=st,tick:b=O,css:m}=i||Ot;m&&(r=gt(s,0,1,p,d,f,m,l++)),b(0,1);const g=at()+d,oe=g+p;a&&a.abort(),o=!0,W(()=>ve(s,!0,"start")),a=ct(j=>{if(o){if(j>=oe)return b(1,0),ve(s,!0,"end"),c(),o=!1;if(j>=g){const E=f((j-g)/p);b(E,1-E)}}return o})}let h=!1;return{start(){h||(h=!0,Se(s),ue(i)?(i=i(n),kt().then(u)):u())},invalidate(){h=!1},end(){o&&(c(),o=!1)}}}function te(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Tt(s,e){const t={},n={},i={$$scope:1};let o=s.length;for(;o--;){const r=s[o],a=e[o];if(a){for(const l in r)l in a||(n[l]=1);for(const l in a)i[l]||(t[l]=a[l],i[l]=1);s[o]=a}else for(const l in r)i[l]=1}for(const r in n)r in t||(t[r]=void 0);return t}function jt(s){return typeof s=="object"&&s!==null?s:{}}function ne(s){s&&s.c()}function M(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),W(()=>{const o=s.$$.on_mount.map(Ue).filter(ue);s.$$.on_destroy?s.$$.on_destroy.push(...o):V(o),s.$$.on_mount=[]}),i.forEach(W)}function H(s,e){const t=s.$$;t.fragment!==null&&(vt(t.after_update),V(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Et(s,e){s.$$.dirty[0]===-1&&($.push(s),_t(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function se(s,e,t,n,i,o,r=null,a=[-1]){const l=B;K(s);const c=s.$$={fragment:null,ctx:[],props:o,update:O,not_equal:i,bound:ge(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:ge(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(s,e.props||{},(h,d,...p)=>{const f=p.length?p[0]:d;return c.ctx&&i(c.ctx[h],c.ctx[h]=f)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](f),u&&Et(s,h)),d}):[],c.update(),u=!0,V(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const h=dt(e.target);c.fragment&&c.fragment.l(h),h.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&y(s.$$.fragment),M(s,e.target,e.anchor),He()}K(l)}class ie{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){H(this,1),this.$destroy=O}$on(e,t){if(!ue(t))return O;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!it(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const It="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(It);function Rt(s){const e=s-1;return e*e*e+1}function At(s,{delay:e=0,duration:t=400,easing:n=Rt,x:i=0,y:o=0,opacity:r=0}={}){const a=getComputedStyle(s),l=+a.opacity,c=a.transform==="none"?"":a.transform,u=l*(1-r),[h,d]=we(i),[p,f]=we(o);return{delay:e,duration:t,easing:n,css:(b,m)=>`
			transform: ${c} translate(${(1-b)*h}${d}, ${(1-b)*p}${f});
			opacity: ${l-u*m}`}}function ke(s,e,t){const n=s.slice();return n[9]=e[t],n}function Oe(s){let e,t,n,i,o,r=s[7]({birth:s[2],death:s[4],place:s[5]})+"",a,l;return{c(){e=P("div"),t=P("h1"),n=R(s[1]),i=x(),o=P("h2"),a=R(r),C(t,"class","svelte-1cu82sv"),C(o,"class","svelte-1cu82sv"),C(e,"class","sticky svelte-1cu82sv")},m(c,u){T(c,e,u),S(e,t),S(t,n),S(e,i),S(e,o),S(o,a)},p(c,u){u&2&&X(n,c[1]),u&52&&r!==(r=c[7]({birth:c[2],death:c[4],place:c[5]})+"")&&X(a,r)},i(c){c&&(l||W(()=>{l=Pt(e,At,{x:-50}),l.start()}))},o:O,d(c){c&&k(e)}}}function Pe(s){let e,t=s[9]+"",n;return{c(){e=P("p"),n=R(t),C(e,"class","svelte-1cu82sv")},m(i,o){T(i,e,o),S(e,n)},p(i,o){o&8&&t!==(t=i[9]+"")&&X(n,t)},d(i){i&&k(e)}}}function qt(s){let e=s[0],t,n,i=Oe(s),o=te(s[6](s[3])),r=[];for(let a=0;a<o.length;a+=1)r[a]=Pe(ke(s,o,a));return{c(){i.c(),t=x(),n=P("div");for(let a=0;a<r.length;a+=1)r[a].c();C(n,"class","svelte-1cu82sv")},m(a,l){i.m(a,l),T(a,t,l),T(a,n,l);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(n,null)},p(a,[l]){if(l&1&&F(e,e=a[0])?(de(),v(i,1,1,O),fe(),i=Oe(a),i.c(),y(i,1),i.m(t.parentNode,t)):i.p(a,l),l&72){o=te(a[6](a[3]));let c;for(c=0;c<o.length;c+=1){const u=ke(a,o,c);r[c]?r[c].p(u,l):(r[c]=Pe(u),r[c].c(),r[c].m(n,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},i(a){y(i)},o(a){v(i)},d(a){a&&(k(t),k(n)),i.d(a),Me(r,a)}}}function Lt(s,e,t){let{id:n=""}=e,{name:i="No name"}=e,{birth:o="No birth"}=e,{description:r="Žádné další informace"}=e,{death:a=""}=e,{place:l=""}=e;const c=(d,p="")=>d||p,u=d=>{const p=c(d,"Žádné další informace");return typeof p=="string"?[p]:p},h=d=>{let p="";const{birth:f,death:b,place:m}=d;return p+=f?"*"+f:"",p+=m?` (${m})`:"",p+=b?" - †"+b:"",p};return s.$$set=d=>{"id"in d&&t(0,n=d.id),"name"in d&&t(1,i=d.name),"birth"in d&&t(2,o=d.birth),"description"in d&&t(3,r=d.description),"death"in d&&t(4,a=d.death),"place"in d&&t(5,l=d.place)},[n,i,o,r,a,l,u,h]}class $t extends ie{constructor(e){super(),se(this,e,Lt,qt,F,{id:0,name:1,birth:2,description:3,death:4,place:5})}}function Te(s,e,t){const n=s.slice();return n[5]=e[t],n}const Ut=s=>({item:s&32}),je=s=>({item:s[5]}),Nt=s=>({item:s&1}),Ee=s=>({item:s[5]});function Dt(s){let e;return{c(){e=R("No slot")},m(t,n){T(t,e,n)},d(t){t&&k(e)}}}function Ie(s){let e,t;return e=new Ve({props:{items:s[5].children,$$slots:{default:[Ft,({item:n})=>({5:n}),({item:n})=>n?32:0]},$$scope:{ctx:s}}}),{c(){ne(e.$$.fragment)},m(n,i){M(e,n,i),t=!0},p(n,i){const o={};i&1&&(o.items=n[5].children),i&48&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function xt(s){let e;return{c(){e=R("No slot")},m(t,n){T(t,e,n)},d(t){t&&k(e)}}}function Ft(s){let e;const t=s[3].default,n=Ne(t,s,s[4],je),i=n||xt();return{c(){i&&i.c()},m(o,r){i&&i.m(o,r),e=!0},p(o,r){n&&n.p&&(!e||r&48)&&Fe(n,t,o,o[4],e?xe(t,o[4],r,Ut):ze(o[4]),je)},i(o){e||(y(i,o),e=!0)},o(o){v(i,o),e=!1},d(o){i&&i.d(o)}}}function Re(s){let e,t,n,i;const o=s[3].default,r=Ne(o,s,s[4],Ee),a=r||Dt();let l=s[5].children&&Ie(s);return{c(){e=P("li"),a&&a.c(),t=x(),l&&l.c(),n=x(),C(e,"class","svelte-9anj3v")},m(c,u){T(c,e,u),a&&a.m(e,null),S(e,t),l&&l.m(e,null),S(e,n),i=!0},p(c,u){r&&r.p&&(!i||u&17)&&Fe(r,o,c,c[4],i?xe(o,c[4],u,Nt):ze(c[4]),Ee),c[5].children?l?(l.p(c,u),u&1&&y(l,1)):(l=Ie(c),l.c(),y(l,1),l.m(e,n)):l&&(de(),v(l,1,1,()=>{l=null}),fe())},i(c){i||(y(a,c),y(l),i=!0)},o(c){v(a,c),v(l),i=!1},d(c){c&&k(e),a&&a.d(c),l&&l.d()}}}function zt(s){let e,t,n,i=te(s[0]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Re(Te(s,i,a));const r=a=>v(o[a],1,1,()=>{o[a]=null});return{c(){e=P("ul");for(let a=0;a<o.length;a+=1)o[a].c();C(e,"class",t=ye(s[1].class)+" svelte-9anj3v")},m(a,l){T(a,e,l);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);n=!0},p(a,[l]){if(l&49){i=te(a[0]);let c;for(c=0;c<i.length;c+=1){const u=Te(a,i,c);o[c]?(o[c].p(u,l),y(o[c],1)):(o[c]=Re(u),o[c].c(),y(o[c],1),o[c].m(e,null))}for(de(),c=i.length;c<o.length;c+=1)r(c);fe()}(!n||l&2&&t!==(t=ye(a[1].class)+" svelte-9anj3v"))&&C(e,"class",t)},i(a){if(!n){for(let l=0;l<i.length;l+=1)y(o[l]);n=!0}},o(a){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)v(o[l]);n=!1},d(a){a&&k(e),Me(o,a)}}}function Kt(s,e,t){let{$$slots:n={},$$scope:i}=e,{items:o=[]}=e;const r=!1;return s.$$set=a=>{t(1,e=Y(Y({},e),be(a))),"items"in a&&t(0,o=a.items),"$$scope"in a&&t(4,i=a.$$scope)},e=be(e),[o,e,r,n,i]}class Ve extends ie{constructor(e){super(),se(this,e,Kt,zt,F,{items:0,treeChild:2})}get treeChild(){return this.$$.ctx[2]}}const L=[];function Ge(s,e=O){let t;const n=new Set;function i(a){if(F(s,a)&&(s=a,t)){const l=!L.length;for(const c of n)c[1](),L.push(c,s);if(l){for(let c=0;c<L.length;c+=2)L[c][0](L[c+1]);L.length=0}}}function o(a){i(a(s))}function r(a,l=O){const c=[a,l];return n.add(c),n.size===1&&(t=e(i,o)||O),a(s),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:r}}const Je=Ge({name:"Rodokmen Rodu Lajsků",birth:"cca 1680 - 2023",description:"Ačkoli v současné době je příjmení rodu ustáleno na podobě „Lajsek“, až do druhé poloviny 19. století se v matrikách objevovaly jeho různé varianty jako Laisek, Laysek, Lejsek, Leisek, či Leysek, a to v závislosti na zapisovateli nebo na tom jak a kdo údaje do zápisu diktoval, nebo jak to vyplývalo ze starších písemných dokumentů. Proto jsou zde uvedeny varianty příjmení tak, jak byly u jednotlivých osob zapsány, u novorozenců pak podle varianty příjmení jejich otce, která byla zrovna tehdy zapsána. Proto není nijak výjimečné, že se sourozenci ve variantě příjmení mezi sebou mohou lišit. V některých případech lze pak pozorovat, jak se v té či oné větvi rodiny ta která varianta začala ustalovat. Rod byl od 17. až do poloviny 20. století usídlený v poměrně malé oblasti jihozápadně od Kutné Hory (Suchdol, Dobřeň, Roztěž, Malešov, Křesetice a Rápošov)."}),Ae=Ge([]);function Bt(s){let e,t=s[2].name+"",n,i,o,r;function a(){return s[1](s[2])}return{c(){e=P("a"),n=R(t),C(e,"href",i="#"+s[2].id)},m(l,c){T(l,e,c),S(e,n),o||(r=ht(e,"click",a),o=!0)},p(l,c){s=l,c&4&&t!==(t=s[2].name+"")&&X(n,t),c&4&&i!==(i="#"+s[2].id)&&C(e,"href",i)},d(l){l&&k(e),o=!1,r()}}}function Wt(s){let e,t;return e=new Ve({props:{class:"treeRoot",items:s[0],$$slots:{default:[Bt,({item:n})=>({2:n}),({item:n})=>n?4:0]},$$scope:{ctx:s}}}),{c(){ne(e.$$.fragment)},m(n,i){M(e,n,i),t=!0},p(n,[i]){const o={};i&1&&(o.items=n[0]),i&12&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function Mt(s,e,t){let{treeData:n=[]}=e;const i=o=>Je.set(o);return s.$$set=o=>{"treeData"in o&&t(0,n=o.treeData)},[n,i]}class Ht extends ie{constructor(e){super(),se(this,e,Mt,Wt,F,{treeData:0})}}const Qe=(s,e=void 0)=>{const t=[];return s.forEach(n=>{if(n.parent===e){const i=Qe(s,n.id),o={...n};i.length>0&&(o.children=i),t.push(o)}}),t};class _ extends Error{constructor(e){var t,n,i,o;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,_.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof _||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(o=(i=(n=this.originalError)==null?void 0:n.cause)==null?void 0:i.message)!=null&&o.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const J=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Vt(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},e||{}).decode||Gt;let i=0;for(;i<s.length;){const o=s.indexOf("=",i);if(o===-1)break;let r=s.indexOf(";",i);if(r===-1)r=s.length;else if(r<o){i=s.lastIndexOf(";",o-1)+1;continue}const a=s.slice(i,o).trim();if(t[a]===void 0){let l=s.slice(o+1,r).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1));try{t[a]=n(l)}catch{t[a]=l}}i=r+1}return t}function qe(s,e,t){const n=Object.assign({},t||{}),i=n.encode||Jt;if(!J.test(s))throw new TypeError("argument name is invalid");const o=i(e);if(o&&!J.test(o))throw new TypeError("argument val is invalid");let r=s+"="+o;if(n.maxAge!=null){const a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(a)}if(n.domain){if(!J.test(n.domain))throw new TypeError("option domain is invalid");r+="; Domain="+n.domain}if(n.path){if(!J.test(n.path))throw new TypeError("option path is invalid");r+="; Path="+n.path}if(n.expires){if(!function(l){return Object.prototype.toString.call(l)==="[object Date]"||l instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function Gt(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function Jt(s){return encodeURIComponent(s)}let Ye;function D(s){if(s)try{const e=decodeURIComponent(Ye(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Xe(s,e=0){let t=D(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Ye=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,o=0,r="";n=e.charAt(o++);~n&&(t=i%4?64*t+n:n,i++%4)?r+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return r};const Le="pb_auth";class Qt{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Xe(this.token)}get isAdmin(){return D(this.token).type==="admin"}get isAuthRecord(){return D(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Le){const n=Vt(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=Le){var l,c;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=D(this.token);n.expires=i!=null&&i.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const o={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let r=qe(t,JSON.stringify(o),e);const a=typeof Blob<"u"?new Blob([r]).size:r.length;if(o.model&&a>4096){o.model={id:(l=o==null?void 0:o.model)==null?void 0:l.id,email:(c=o==null?void 0:o.model)==null?void 0:c.email};const u=["collectionId","username","verified"];for(const h in this.model)u.includes(h)&&(o.model[h]=this.model[h]);r=qe(t,JSON.stringify(o),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Yt extends Qt{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class A{constructor(e){this.client=e}}class Xt extends A{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,n,i,o,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:o}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}class pe extends A{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>{var o;return i.items=((o=i.items)==null?void 0:o.map(r=>this.decode(r)))||[],i})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var i;if(!((i=n==null?void 0:n.items)!=null&&i.length))throw new _({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new _({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async o=>this.getList(o,e||500,t).then(r=>{const a=r.items;return n=n.concat(a),a.length==r.perPage?i(o+1):n});return i(1)}}function w(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function ce(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class Zt extends pe{get baseCrudPath(){return"/api/admins"}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r;return((o=this.client.authStore.model)==null?void 0:o.id)===i.id&&((r=this.client.authStore.model)==null?void 0:r.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o;return n&&((i=this.client.authStore.model)==null?void 0:i.id)===e&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};o=w("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",o,n,i);const r=o.autoRefreshThreshold;delete o.autoRefreshThreshold,o.autoRefresh||ce(this.client);let a=await this.client.send(this.baseCrudPath+"/auth-with-password",o);return a=this.authResponse(a),r&&function(c,u,h,d){ce(c);const p=c.beforeSend,f=c.authStore.model,b=c.authStore.onChange((m,g)=>{(!m||(g==null?void 0:g.id)!=(f==null?void 0:f.id)||(g!=null&&g.collectionId||f!=null&&f.collectionId)&&(g==null?void 0:g.collectionId)!=(f==null?void 0:f.collectionId))&&ce(c)});c._resetAutoRefresh=function(){b(),c.beforeSend=p,delete c._resetAutoRefresh},c.beforeSend=async(m,g)=>{var me;const oe=c.authStore.token;if((me=g.query)!=null&&me.autoRefresh)return p?p(m,g):{url:m,sendOptions:g};let j=c.authStore.isValid;if(j&&Xe(c.authStore.token,u))try{await h()}catch{j=!1}j||await d();const E=g.headers||{};for(let G in E)if(G.toLowerCase()=="authorization"&&oe==E[G]&&c.authStore.token){E[G]=c.authStore.token;break}return g.headers=E,p?p(m,g):{url:m,sendOptions:g}}}(this.client,r,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},o))),a}async authRefresh(e,t){let n={method:"POST"};return n=w("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=w("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=w("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCrudPath+"/confirm-password-reset",r).then(()=>!0)}}const en=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Ze(s){if(s){s.query=s.query||{};for(let e in s)en.includes(e)||(s.query[e]=s[e],delete s[e])}}class et extends A{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var r;if(!e)throw new Error("topic must be set.");let i=e;if(n){Ze(n);const a="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+a}const o=function(a){const l=a;let c;try{c=JSON.parse(l==null?void 0:l.data)}catch{}t(c||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(o),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(i,o):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,o)}async unsubscribe(e){var n;let t=!1;if(e){const i=this.getSubscriptionsByTopic(e);for(let o in i)if(this.hasSubscriptionListeners(o)){for(let r of this.subscriptions[o])(n=this.eventSource)==null||n.removeEventListener(o,r);delete this.subscriptions[o],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let i in this.subscriptions)if((i+"?").startsWith(e)){t=!0;for(let o of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,o);delete this.subscriptions[i]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var o;let n=!1;const i=this.getSubscriptionsByTopic(e);for(let r in i){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let a=!1;for(let l=this.subscriptions[r].length-1;l>=0;l--)this.subscriptions[r][l]===t&&(a=!0,delete this.subscriptions[r][l],this.subscriptions[r].splice(l,1),(o=this.eventSource)==null||o.removeEventListener(r,t));a&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let i in this.subscriptions)if((n=this.subscriptions[i])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let o of n[i])o(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new _(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class tn extends pe{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r,a;return((o=this.client.authStore.model)==null?void 0:o.id)!==(i==null?void 0:i.id)||((r=this.client.authStore.model)==null?void 0:r.collectionId)!==this.collectionIdOrName&&((a=this.client.authStore.model)==null?void 0:a.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o,r;return!n||((i=this.client.authStore.model)==null?void 0:i.id)!==e||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.model)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};return o=w("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/auth-with-password",o).then(r=>this.authResponse(r))}async authWithOAuth2Code(e,t,n,i,o,r,a){let l={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:i,createData:o}};return l=w("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",l,r,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",l).then(c=>this.authResponse(c))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},n=(await this.listAuthMethods()).authProviders.find(l=>l.name===t.provider);if(!n)throw new _(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),o=new et(this.client);let r=null;function a(){r==null||r.close(),o.unsubscribe()}return t.urlCallback||(r=$e(void 0)),new Promise(async(l,c)=>{var u;try{await o.subscribe("@oauth2",async f=>{const b=o.clientId;try{if(!f.state||b!==f.state)throw new Error("State parameters don't match.");if(f.error||!f.code)throw new Error("OAuth2 redirect error or missing code: "+f.error);const m=Object.assign({},t);delete m.provider,delete m.scopes,delete m.createData,delete m.urlCallback;const g=await this.authWithOAuth2Code(n.name,f.code,n.codeVerifier,i,t.createData,m);l(g)}catch(m){c(new _(m))}a()});const h={state:o.clientId};(u=t.scopes)!=null&&u.length&&(h.scope=t.scopes.join(" "));const d=this._replaceQueryParams(n.authUrl+i,h);await(t.urlCallback||function(f){r?r.location.href=f:r=$e(f)})(d)}catch(h){a(),c(new _(h))}})}async authRefresh(e,t){let n={method:"POST"};return n=w("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=w("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=w("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=w("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}async confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=w("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>{const o=D(e),r=this.client.authStore.model;return r&&!r.verified&&r.id===o.id&&r.collectionId===o.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=w("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}async confirmEmailChange(e,t,n,i){let o={method:"POST",body:{token:e,password:t}};return o=w("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",o).then(()=>{const r=D(e),a=this.client.authStore.model;return a&&a.id===r.id&&a.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const o={},r=i.split("&");for(const a of r){if(a=="")continue;const l=a.split("=");o[decodeURIComponent(l[0].replace(/\+/g," "))]=decodeURIComponent((l[1]||"").replace(/\+/g," "))}for(let a in t)t.hasOwnProperty(a)&&(t[a]==null?delete o[a]:o[a]=t[a]);i="";for(let a in o)o.hasOwnProperty(a)&&(i!=""&&(i+="&"),i+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(o[a].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function $e(s){if(typeof window>"u"||!(window!=null&&window.open))throw new _(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let o=n/2-e/2,r=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+r+",left="+o+",resizable,menubar=no")}class nn extends pe{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class sn extends A{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new _({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class on extends A{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class rn extends A{getUrl(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let o=this.client.buildUrl(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const r=new URLSearchParams(n);o+=(o.includes("?")?"&":"?")+r}return o}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class an extends A{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class cn{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new Yt,this.admins=new Zt(this),this.collections=new nn(this),this.files=new rn(this),this.logs=new sn(this),this.settings=new Xt(this),this.realtime=new et(this),this.health=new on(this),this.backups=new an(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new tn(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){var n;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let o={};try{o=await i.json()}catch{}if(this.afterSend&&(o=await this.afterSend(i,o)),i.status>=400)throw new _({url:i.url,status:i.status,data:o});return o}).catch(i=>{throw new _(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),Ze(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(const n in e){const i=e[n];if(typeof i!="object"||this.hasBlobField({data:i})){const o=Array.isArray(i)?i:[i];for(let r of o)t.append(n,r)}else{let o={};o[n]=i,t.append("@jsonPayload",JSON.stringify(o))}}return t}hasBlobField(e){for(const t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(const i of n)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const i=e[n],o=encodeURIComponent(n);if(Array.isArray(i))for(const r of i)t.push(o+"="+encodeURIComponent(r));else i instanceof Date?t.push(o+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(o+"="+encodeURIComponent(JSON.stringify(i))):t.push(o+"="+encodeURIComponent(i))}return t.join("&")}}const ln=new cn("https://db.cubiq.dev/"),un=async s=>{const e=await ln.collection(s).getFullList().catch(n=>{throw console.error(n),n}),t=e.map(n=>{var f;const{id:i,parent:o,UID:r,collectionId:a,collectionName:l,created:c,updated:u,expand:h,...d}=n,p=(f=e.find(b=>b.id===o))==null?void 0:f.UID;return{id:r,parent:p,...d}});return console.log("Processed list",t),t};function hn(s){let e,t,n,i,o,r,a;t=new Ht({props:{treeData:s[1]}});const l=[s[0]];let c={};for(let u=0;u<l.length;u+=1)c=Y(c,l[u]);return i=new $t({props:c}),{c(){e=P("main"),ne(t.$$.fragment),n=x(),ne(i.$$.fragment),o=x(),r=P("footer"),r.innerHTML='<a href="https://cubiq.dev">coded with 🤍 by Jakub Lajsek</a> <a href="https://github.com/TheCubiq/family-tree-svelte">zdrojový kód zde</a>',C(r,"class","svelte-d0qz53"),C(e,"class","svelte-d0qz53")},m(u,h){T(u,e,h),M(t,e,null),S(e,n),M(i,e,null),S(e,o),S(e,r),a=!0},p(u,[h]){const d={};h&2&&(d.treeData=u[1]),t.$set(d);const p=h&1?Tt(l,[jt(u[0])]):{};i.$set(p)},i(u){a||(y(t.$$.fragment,u),y(i.$$.fragment,u),a=!0)},o(u){v(t.$$.fragment,u),v(i.$$.fragment,u),a=!1},d(u){u&&k(e),H(t),H(i)}}}function dn(s,e,t){let n;rt(s,Ae,o=>t(1,n=o));let i;return Je.subscribe(o=>{t(0,i=o)}),wt(async()=>{const o=await un("tree_lajsek"),r=Qe(o);Ae.set(r)}),[i,n]}class fn extends ie{constructor(e){super(),se(this,e,dn,hn,F,{})}}new fn({target:document.getElementById("app")});
